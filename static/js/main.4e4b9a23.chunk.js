(this["webpackJsonpit-incubator-todolist-ts"]=this["webpackJsonpit-incubator-todolist-ts"]||[]).push([[0],{101:function(t,e,n){},125:function(t,e,n){},131:function(t,e,n){"use strict";n.r(e);var a,i,s,c=n(0),o=n.n(c),r=n(9),d=n.n(r),u=(n(101),function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,186)).then((function(e){var n=e.getCLS,a=e.getFID,i=e.getFCP,s=e.getLCP,c=e.getTTFB;n(t),a(t),i(t),s(t),c(t)}))}),l=n(17),j=n(20),f=n(78),b=n.n(f);!function(t){t[t.Active=0]="Active",t[t.InProgress=1]="InProgress",t[t.Completed=2]="Completed",t[t.Draft=3]="Draft"}(a||(a={})),function(t){t[t.Low=0]="Low",t[t.Middle=1]="Middle",t[t.High=2]="High",t[t.Urgent=3]="Urgent",t[t.Irrelevant=4]="Irrelevant"}(i||(i={})),function(t){t[t.Success=0]="Success",t[t.Error=1]="Error",t[t.Captcha=10]="Captcha"}(s||(s={}));var h=b.a.create({baseURL:"https://social-network.samuraijs.com/api/1.1/",withCredentials:!0,headers:{"API-KEY":"264a0581-6cdc-4a28-9b7e-b8b5b1060aa0"}}),O=function(){return h.get("auth/me")},p=function(t){return h.post("auth/login",t)},g=function(){return h.delete("auth/login")},m=function(){return h.get("todo-lists")},x=function(t){return h.post("todo-lists",{title:t})},k=function(t){return h.delete("todo-lists/".concat(t))},y=function(t,e){return h.put("todo-lists/".concat(t),{title:e})},v=function(t){return h.get("todo-lists/".concat(t,"/tasks"))},I=function(t,e){return h.delete("todo-lists/".concat(t,"/tasks/").concat(e))},S=function(t,e){return h.post("todo-lists/".concat(t,"/tasks"),{title:e})},T=function(t,e,n){return h.put("todo-lists/".concat(t,"/tasks/").concat(e),n)},C=function(t,e){t(G({error:e})),t(_({status:"failed"}))},w=function(t,e){e.messages.length?t(G({error:e.messages[0]})):t(G({error:"Error occurred"})),t(_({status:"failed"}))},E=n(27),L=Object(E.b)({name:"todolists",initialState:[],reducers:{removeTodolist:function(t,e){var n=t.findIndex((function(t){return t.id===e.payload.id}));-1!==n&&t.splice(n,1)},addTodolist:function(t,e){t.unshift(Object(j.a)(Object(j.a)({},e.payload.todolist),{},{filter:"all",entityStatus:"idle"}))},changeTodolistTitle:function(t,e){var n=t.findIndex((function(t){return t.id===e.payload.id}));-1!==n&&(t[n].title=e.payload.title)},changeTodolistFilter:function(t,e){var n=t.findIndex((function(t){return t.id===e.payload.id}));-1!==n&&(t[n].filter=e.payload.filter)},changeTodolistEntityStatus:function(t,e){var n=t.findIndex((function(t){return t.id===e.payload.id}));-1!==n&&(t[n].entityStatus=e.payload.entityStatus)},setTodolists:function(t,e){return e.payload.todolists.map((function(t){return Object(j.a)(Object(j.a)({},t),{},{filter:"all",entityStatus:"idle"})}))},clearTodolistsData:function(t){return[]}}}),A=L.reducer,F=L.actions,P=F.changeTodolistEntityStatus,D=F.changeTodolistFilter,z=F.changeTodolistTitle,M=F.removeTodolist,R=F.setTodolists,N=F.clearTodolistsData,U=F.addTodolist,q=Object(E.b)({name:"auth",initialState:{isLoggedIn:!1},reducers:{setIsLoggedIn:function(t,e){t.isLoggedIn=e.payload.isLoggedIn}}}),B=q.reducer,H=q.actions.setIsLoggedIn,Z=Object(E.b)({name:"app",initialState:{status:"idle",error:null,isInitialized:!1},reducers:{setAppStatus:function(t,e){t.status=e.payload.status},setAppError:function(t,e){t.error=e.payload.error},setIsInitialized:function(t,e){t.isInitialized=e.payload.isInitialized}}}),J=Z.reducer,K=Z.actions,_=K.setAppStatus,G=K.setAppError,V=K.setIsInitialized,Y=Object(E.b)({name:"tasks",initialState:{},reducers:{removeTask:function(t,e){var n=t[e.payload.todolistId],a=n.findIndex((function(t){return t.id===e.payload.taskId}));-1!==a&&n.splice(a,1)},addTask:function(t,e){t[e.payload.task.todoListId].unshift(e.payload.task)},updateTask:function(t,e){var n=t[e.payload.todolistId],a=n.findIndex((function(t){return t.id===e.payload.taskId}));-1!==a&&(n[a]=Object(j.a)(Object(j.a)({},n[a]),e.payload.model))},changeTaskEntityStatus:function(t,e){var n=t[e.payload.todolistId],a=n.findIndex((function(t){return t.id===e.payload.taskId}));-1!==a&&(n[a].entityStatus=e.payload.entityStatus)},setTasks:function(t,e){t[e.payload.todolistId]=e.payload.tasks}},extraReducers:function(t){t.addCase(U,(function(t,e){t[e.payload.todolist.id]=[]})),t.addCase(M,(function(t,e){delete t[e.payload.id]})),t.addCase(R,(function(t,e){e.payload.todolists.forEach((function(e){t[e.id]=[]}))})),t.addCase(N,(function(t){return{}}))}}),$=Y.reducer,Q=Y.actions,W=Q.changeTaskEntityStatus,X=Q.removeTask,tt=Q.setTasks,et=Q.addTask,nt=Q.updateTask,at=function(t){return function(e){e(_({status:"loading"})),v(t).then((function(n){n.data.error?(e(G({error:"Error occurred"})),e(_({status:"failed"}))):(e(tt({tasks:n.data.items,todolistId:t})),e(_({status:"succeeded"})))})).catch((function(t){C(e,t.message)}))}},it=function(t,e,n){return function(a,i){var c=i().tasks[n].find((function(e){return e.id===t}));if(c){var o=Object(j.a)({deadline:c.deadline,description:c.description,priority:c.priority,startDate:c.startDate,title:c.title,status:c.status},e);a(_({status:"loading"})),a(W({todolistId:n,taskId:t,entityStatus:"loading"})),T(n,t,o).then((function(i){i.data.resultCode===s.Success?(a(nt({taskId:t,model:e,todolistId:n})),a(_({status:"succeeded"})),a(W({todolistId:n,taskId:t,entityStatus:"succeeded"}))):(w(a,i.data),a(W({todolistId:n,taskId:t,entityStatus:"failed"})))})).catch((function(t){C(a,t.message)}))}else console.warn("task not found in the state")}},st=n(79),ct=n(47),ot=Object(st.a)({tasks:$,todolists:A,app:J,auth:B}),rt=Object(E.a)({reducer:ot,middleware:function(t){return t().prepend(ct.a)}});window.store=rt;n(125);var dt=n(173),ut=n(174),lt=n(175),jt=n(167),ft=n(170),bt=n(177),ht=n(178),Ot=n(176),pt=n(171),gt=n(132),mt=n(44),xt=n(179),kt=n(168),yt=n(3),vt=o.a.memo((function(t){var e=Object(c.useState)(""),n=Object(mt.a)(e,2),a=n[0],i=n[1],s=Object(c.useState)(null),o=Object(mt.a)(s,2),r=o[0],d=o[1],u=function(){""!==a.trim()?(t.addItem(a),i("")):d("Title is required")};return Object(yt.jsxs)("div",{children:[Object(yt.jsx)(xt.a,{variant:"outlined",error:!!r,value:a,onChange:function(t){i(t.currentTarget.value)},onKeyPress:function(t){null!==r&&d(null),"Enter"===t.key&&u()},label:"Title",helperText:r,disabled:"loading"===t.entityStatus}),Object(yt.jsx)(jt.a,{color:"primary",onClick:u,disabled:"loading"===t.entityStatus,children:Object(yt.jsx)(kt.a,{})})]})})),It=o.a.memo((function(t){var e=Object(c.useState)(!1),n=Object(mt.a)(e,2),a=n[0],i=n[1],s=Object(c.useState)(t.value),o=Object(mt.a)(s,2),r=o[0],d=o[1];return a?Object(yt.jsx)(xt.a,{value:r,onChange:function(t){d(t.currentTarget.value)},autoFocus:!0,onBlur:function(){i(!1),t.onChange(r)},disabled:"loading"===t.entityStatus}):Object(yt.jsx)("span",{onDoubleClick:function(){i(!0),d(t.value)},children:t.value})})),St=n(169),Tt=n(181),Ct=o.a.memo((function(t){var e=t.task,n=t.changeTaskStatus,i=t.changeTaskTitle,s=t.removeTask,o=t.todolistId,r=Object(c.useCallback)((function(){return s(e.id,o)}),[e.id,o,s]),d=Object(c.useCallback)((function(t){var i=t.currentTarget.checked;n(e.id,i?a.Completed:a.Active,o)}),[e.id,o,n]),u=Object(c.useCallback)((function(t){i(e.id,t,o)}),[e.id,o,i]);return Object(yt.jsxs)("div",{className:e.status===a.Completed?"is-done":"",children:[Object(yt.jsx)(Tt.a,{checked:e.status===a.Completed,color:"primary",onChange:d,disabled:"loading"===e.entityStatus}),Object(yt.jsx)(It,{value:e.title,onChange:u,entityStatus:e.entityStatus}),Object(yt.jsx)(jt.a,{onClick:r,disabled:"loading"===e.entityStatus,children:Object(yt.jsx)(St.a,{})})]},e.id)})),wt=o.a.memo((function(t){var e=t.id,n=t.filter,i=t.removeTask,s=t.changeTaskStatus,o=t.entityStatus,r=t.changeTaskTitle,d=t.changeFilter,u=t.title,l=t.tasks,j=t.changeTodolistTitle,f=t.removeTodolist,b=t.addTask,h=Object(c.useCallback)((function(t){b(t,e)}),[b,e]),O=Object(c.useCallback)((function(t){j(e,t)}),[e,j]),p=Object(c.useCallback)((function(){return d("all",e)}),[e,d]),g=Object(c.useCallback)((function(){return d("active",e)}),[e,d]),m=Object(c.useCallback)((function(){return d("completed",e)}),[e,d]),x=l;return"active"===n&&(x=l.filter((function(t){return t.status===a.Active}))),"completed"===n&&(x=l.filter((function(t){return t.status===a.Completed}))),Object(yt.jsxs)("div",{children:[Object(yt.jsxs)("h3",{children:[Object(yt.jsx)(It,{value:u,onChange:O,entityStatus:o}),Object(yt.jsx)(jt.a,{onClick:function(){f(e)},disabled:"loading"===o,children:Object(yt.jsx)(St.a,{})})]}),Object(yt.jsx)(vt,{addItem:h,entityStatus:o}),Object(yt.jsx)("div",{children:x.map((function(t){return Object(yt.jsx)(Ct,{task:t,todolistId:e,removeTask:i,changeTaskTitle:r,changeTaskStatus:s},t.id)}))}),Object(yt.jsxs)("div",{style:{paddingTop:"10px"},children:[Object(yt.jsx)(ft.a,{variant:"all"===n?"outlined":"text",onClick:p,color:"default",children:"All"}),Object(yt.jsx)(ft.a,{variant:"active"===n?"outlined":"text",onClick:g,color:"primary",children:"Active"}),Object(yt.jsx)(ft.a,{variant:"completed"===n?"outlined":"text",onClick:m,color:"secondary",children:"Completed"})]})]})})),Et=n(13),Lt=function(){var t=Object(l.b)(),e=Object(l.c)((function(t){return t.todolists})),n=Object(l.c)((function(t){return t.tasks})),a=Object(l.c)((function(t){return t.auth.isLoggedIn}));Object(c.useEffect)((function(){a&&t((function(t){t(_({status:"loading"})),m().then((function(e){return t(R({todolists:e.data})),t(_({status:"succeeded"})),e.data})).then((function(e){e.forEach((function(e){t(at(e.id))}))})).catch((function(e){C(t,e.message)}))}))}),[t,a]);var i=Object(c.useCallback)((function(e,n){t(function(t,e){return function(n){n(_({status:"loading"})),n(W({todolistId:e,taskId:t,entityStatus:"loading"})),I(e,t).then((function(a){a.data.resultCode===s.Success?(n(X({taskId:t,todolistId:e})),n(_({status:"succeeded"})),n(W({todolistId:e,taskId:t,entityStatus:"succeeded"}))):(w(n,a.data),n(W({todolistId:e,taskId:t,entityStatus:"failed"})))})).catch((function(t){C(n,t.message)}))}}(e,n))}),[t]),o=Object(c.useCallback)((function(e,n){t(function(t,e){return function(n){n(_({status:"loading"})),S(e,t).then((function(t){t.data.resultCode===s.Success?(n(et({task:t.data.data.item})),n(_({status:"succeeded"}))):w(n,t.data)})).catch((function(t){C(n,t.message)}))}}(e,n))}),[t]),r=Object(c.useCallback)((function(e,n,a){t(it(e,{status:n},a))}),[t]),d=Object(c.useCallback)((function(e,n,a){t(it(e,{title:n},a))}),[t]),u=Object(c.useCallback)((function(e,n){t(D({id:n,filter:e}))}),[t]),j=Object(c.useCallback)((function(e){t(function(t){return function(e){e(_({status:"loading"})),e(P({id:t,entityStatus:"loading"})),k(t).then((function(n){n.data.resultCode===s.Success?(e(M({id:t})),e(_({status:"succeeded"}))):w(e,n.data)})).catch((function(t){C(e,t.message)}))}}(e))}),[t]),f=Object(c.useCallback)((function(e,n){t(function(t,e){return function(n){n(_({status:"loading"})),n(P({id:t,entityStatus:"loading"})),y(t,e).then((function(a){a.data.resultCode===s.Success?(n(z({id:t,title:e})),n(_({status:"succeeded"})),n(P({id:t,entityStatus:"succeeded"}))):(w(n,a.data),n(P({id:t,entityStatus:"failed"})))})).catch((function(t){C(n,t.message)}))}}(e,n))}),[t]),b=Object(c.useCallback)((function(e){t(function(t){return function(e){e(_({status:"loading"})),x(t).then((function(t){t.data.resultCode===s.Success?(e(U({todolist:t.data.data.item})),e(_({status:"succeeded"}))):w(e,t.data)})).catch((function(t){C(e,t.message)}))}}(e))}),[t]);return a?Object(yt.jsxs)(yt.Fragment,{children:[Object(yt.jsx)(pt.a,{container:!0,style:{padding:"20px"},children:Object(yt.jsx)(vt,{addItem:b})}),Object(yt.jsx)(pt.a,{container:!0,spacing:3,children:e.map((function(t){var e=n[t.id];return Object(yt.jsx)(pt.a,{item:!0,children:Object(yt.jsx)(gt.a,{style:{padding:"10px"},children:Object(yt.jsx)(wt,{id:t.id,title:t.title,tasks:e,entityStatus:t.entityStatus,removeTask:i,changeFilter:u,addTask:o,changeTaskStatus:r,filter:t.filter,removeTodolist:j,changeTaskTitle:d,changeTodolistTitle:f})})},t.id)}))})]}):Object(yt.jsx)(Et.a,{to:"/login"})},At=n(183),Ft=n(180);function Pt(t){return Object(yt.jsx)(Ft.a,Object(j.a)({elevation:6,variant:"filled"},t))}var Dt=function(){var t=Object(l.b)(),e=Object(l.c)((function(t){return t.app.error})),n=function(e,n){"clickaway"!==n&&t(G({error:null}))};return Object(yt.jsx)(At.a,{open:null!==e,autoHideDuration:6e3,onClose:n,children:Object(yt.jsx)(Pt,{onClose:n,severity:"error",children:e})})},zt=n(184),Mt=n(166),Rt=n(172),Nt=n(185),Ut=n(86),qt=function(){var t=Object(l.b)(),e=Object(l.c)((function(t){return t.auth.isLoggedIn})),n=Object(Ut.a)({initialValues:{email:"",password:"",rememberMe:!1},validate:function(t){var e={};return t.email?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,10}$/i.test(t.email)||(e.email="Invalid email address"):e.email="Required field",t.password?t.password.length<=2&&(e.password="Password must contain at least 3 characters"):e.password="Required field",e},onSubmit:function(e){var a;t((a=e,function(t){t(_({status:"loading"})),p(a).then((function(e){e.data.resultCode===s.Success?(t(H({isLoggedIn:!0})),t(_({status:"succeeded"}))):w(t,e.data)})).catch((function(e){C(t,e)}))})),n.resetForm()}});return e?Object(yt.jsx)(Et.a,{to:"/"}):Object(yt.jsx)(pt.a,{container:!0,justify:"center",children:Object(yt.jsx)(pt.a,{item:!0,xs:4,children:Object(yt.jsx)("form",{onSubmit:n.handleSubmit,children:Object(yt.jsxs)(zt.a,{children:[Object(yt.jsxs)(Mt.a,{children:[Object(yt.jsxs)("p",{children:["Sign up to log in ",Object(yt.jsx)("a",{href:"https://social-network.samuraijs.com/",target:"_blank",rel:"noreferrer",children:"here"})]}),Object(yt.jsx)("p",{children:"or use common test account credentials:"}),Object(yt.jsx)("p",{children:"Email: free@samuraijs.com"}),Object(yt.jsx)("p",{children:"Password: free"})]}),Object(yt.jsxs)(Rt.a,{children:[Object(yt.jsx)(xt.a,Object(j.a)({label:"Email",margin:"normal"},n.getFieldProps("email"))),n.touched.email&&n.errors.email&&Object(yt.jsx)("div",{style:{color:"red"},children:n.errors.email}),Object(yt.jsx)(xt.a,Object(j.a)({type:"password",label:"Password",margin:"normal"},n.getFieldProps("password"))),n.touched.password&&n.errors.password&&Object(yt.jsx)("div",{style:{color:"red"},children:n.errors.password}),Object(yt.jsx)(Nt.a,{label:"Remember me",control:Object(yt.jsx)(Tt.a,Object(j.a)({},n.getFieldProps("rememberMe")))}),Object(yt.jsx)(ft.a,{type:"submit",variant:"contained",color:"primary",children:"Login"})]})]})})})})},Bt=function(){var t=Object(l.b)(),e=Object(l.c)((function(t){return t.app.status})),n=Object(l.c)((function(t){return t.app.isInitialized})),a=Object(l.c)((function(t){return t.auth.isLoggedIn}));Object(c.useEffect)((function(){t((function(t){O().then((function(e){e.data.resultCode===s.Success&&t(H({isLoggedIn:!0}))})).catch((function(e){C(t,e)})).finally((function(){t(V({isInitialized:!0}))}))}))}),[t]);return n?Object(yt.jsxs)("div",{className:"App",children:[Object(yt.jsx)(Dt,{}),Object(yt.jsx)(ut.a,{position:"static",children:Object(yt.jsxs)(lt.a,{children:[Object(yt.jsx)(jt.a,{edge:"start",color:"inherit","aria-label":"menu",children:Object(yt.jsx)(Ot.a,{})}),a&&Object(yt.jsx)(ft.a,{onClick:function(){return t((function(t){t(_({status:"loading"})),g().then((function(e){e.data.resultCode===s.Success?(t(H({isLoggedIn:!1})),t(_({status:"succeeded"})),t(N())):w(t,e.data)})).catch((function(e){C(t,e)}))}))},color:"inherit",children:"Logout"})]})}),"loading"===e&&Object(yt.jsx)(bt.a,{color:"secondary"}),Object(yt.jsx)(ht.a,{fixed:!0,children:Object(yt.jsxs)(Et.d,{children:[Object(yt.jsx)(Et.b,{exact:!0,path:"/",render:function(){return Object(yt.jsx)(Lt,{})}}),Object(yt.jsx)(Et.b,{path:"/login",render:function(){return Object(yt.jsx)(qt,{})}}),Object(yt.jsx)(Et.b,{path:"/404",render:function(){return Object(yt.jsx)("h1",{children:"404: PAGE NOT FOUND"})}}),Object(yt.jsx)(Et.a,{from:"*",to:"/404"})]})})]}):Object(yt.jsx)("div",{style:{position:"fixed",top:"30%",textAlign:"center",width:"100%"},children:Object(yt.jsx)(dt.a,{})})},Ht=n(46);d.a.render(Object(yt.jsx)(o.a.StrictMode,{children:Object(yt.jsx)(Ht.a,{children:Object(yt.jsx)(l.a,{store:rt,children:Object(yt.jsx)(Bt,{})})})}),document.getElementById("root")),u()}},[[131,1,2]]]);
//# sourceMappingURL=main.4e4b9a23.chunk.js.map